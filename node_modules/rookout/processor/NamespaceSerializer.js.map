{"version":3,"sources":["../../../src/processor/NamespaceSerializer.js"],"names":["variant_pb","require","timestamp_pb","INT32_MIN","INT32_MAX","INT64_MIN","INT64_MAX","isFloat","n","e","NamespaceSerializer","dumps","namespace","logErrors","variant","Variant","dump","ContainerNamespace","dumpContainerNamespace","JSObjectNamespace","dumpJSObjectNamespace","ListNamespace","dumpListNamespace","DictNamespace","dumpDictNamespace","InspectorObjectNamespace","dumpInspectorObjectNamespace","dumpConfig","DynamicInspectorObjectNamespace","dumpDynamicInspectorObjectNamespace","TypeError","message","clearVariant","setVariantType","Type","VARIANT_ERROR","setErrorValue","RookError","logger","exception","VARIANT_NAMESPACE","result","Namespace","key","Object","keys","namespaces","value","NamedValue","setName","setValue","addAttributes","setNamespaceValue","dumpJSObject","obj","unsafeDumpJSObject","currentDepth","maxDepth","dumpMaxDepth","dumpBaseObject","undefined","VARIANT_UNDEFINED","VARIANT_NONE","VARIANT_INT","setIntValue","Number","isInteger","VARIANT_DOUBLE","setDoubleValue","String","VARIANT_STRING","string","setOriginalSize","length","maxString","substring","setStringValue","Date","VARIANT_TIME","date","Timestamp","isNaN","getTime","fromDate","setTimeValue","Array","isArray","dumpArray","Error","dumpException","VARIANT_CODE_OBJECT","codeValue","CodeObject","name","setCodeValue","dumpUserClass","VARIANT_MAX_DEPTH","setMaxDepthFlag","setMaxDepth","setOriginalType","__proto__","constructor","symbols","getOwnPropertySymbols","objectKeys","objectWidth","objectWeight","maxWidth","parseInt","toString","getOwnPropertyDescriptor","VARIANT_DYNAMIC","attribute","index","symbol","symbolName","VARIANT_LIST","list","List","setType","getCommonType","maxCollectionDepth","maxItems","Math","min","i","item","addValues","setListValue","VARIANT_OBJECT","messageValue","messagePair","stackValue","stack","stackPair","originalType","listValue","commonType","originalSize","VARIANT_MAP","dictValue","Map","dict","pair","Pair","setFirst","setSecond","addPairs","setMapValue","unsafeDumpInspectorObjectNamespace","className","type","functionName","readAttribute","subtype","dumpInspectorArray","dumpInspectorDate","loadProperties","property","properties","RookInspectorUnknownProperty","getObjectInternal","inspector","lengthString","description","match","timeValue","clearAttributesList","clearIntValue","clearLongValue","clearDoubleValue","clearStringValue","clearListValue","clearMapValue","clearNamespaceValue","clearErrorValue","clearMessageValue","clearTimeValue","clearCodeValue","clearLargeIntValue","clearComplexValue"],"mappings":"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","sourcesContent":["\"use strict\";\n\nimport InspectorObjectNamespace from \"./namespaces/InspectorObjectNamespace\";\n\nconst variant_pb = require('../protobuf/variant_pb');\nconst timestamp_pb = require('google-protobuf/google/protobuf/timestamp_pb');\n\nimport {logger} from \"../logger\";\n\nimport RookError from './RookError';\n\n// Copied from Python Google Protobuf\nconst INT32_MIN = -2147483648;\nconst INT32_MAX = 2147483647;\nconst INT64_MIN = -9223372036854775808;\nconst INT64_MAX = 9223372036854775807;\n\nimport ContainerNamespace from './namespaces/ContainerNamespace';\nimport JSObjectNamespace from './namespaces/JSObjectNamespace';\nimport ListNamespace from './namespaces/ListNamespace';\nimport DynamicInspectorObjectNamespace from \"./namespaces/DynamicInspectorObjectNamespace\";\nimport DictNamespace from \"./namespaces/DictNamespace\";\n\nfunction isFloat(n) {\n    try {\n        // This seems to throw sometimes :(\n        return n === +n && n !== (n|0);\n    } catch (e) {\n        return false;\n    }\n}\n\nexport default class NamespaceSerializer {\n    dumps(namespace, logErrors = true) {\n        let variant = new variant_pb.Variant();\n        this.dump(namespace, variant, logErrors);\n        return variant;\n    }\n\n    dump(namespace, variant, logErrors = true) {\n        try {\n            if (namespace instanceof ContainerNamespace) {\n                this.dumpContainerNamespace(namespace, variant, logErrors);\n            } else if (namespace instanceof JSObjectNamespace) {\n                this.dumpJSObjectNamespace(namespace, variant, logErrors);\n            } else if (namespace instanceof ListNamespace) {\n                this.dumpListNamespace(namespace, variant, logErrors);\n            } else if (namespace instanceof DictNamespace) {\n                this.dumpDictNamespace(namespace, variant, logErrors);\n            } else if (namespace instanceof InspectorObjectNamespace) {\n                this.dumpInspectorObjectNamespace(namespace, variant, 0, namespace.dumpConfig, logErrors);\n            } else if (namespace instanceof DynamicInspectorObjectNamespace) {\n                this.dumpDynamicInspectorObjectNamespace(variant);\n            } else {\n                throw new TypeError(\"Does not support serializing this type: \" + typeof namespace)\n            }\n        }\n        catch (e) {\n            const message = \"Failed to serialize namespace\";\n\n            this.clearVariant(variant);\n            variant.setVariantType(variant_pb.Variant.Type.VARIANT_ERROR);\n\n            if (logErrors) {\n                variant.setErrorValue(new RookError(e, message).dumps());\n                logger.exception(message, e);\n            }\n        }\n    }\n\n    dumpContainerNamespace(namespace, variant, logErrors) {\n        variant.setVariantType(variant_pb.Variant.Type.VARIANT_NAMESPACE);\n\n        let result = new variant_pb.Variant.Namespace();\n        for (let key of Object.keys(namespace.namespaces)) {\n            let value = new variant_pb.Variant.NamedValue();\n            value.setName(key);\n            value.setValue(this.dumps(namespace.namespaces[key], logErrors));\n\n            result.addAttributes(value);\n        }\n\n        variant.setNamespaceValue(result);\n    }\n\n    dumpJSObjectNamespace(namespace, variant, logErrors) {\n        this.dumpJSObject(namespace.obj, variant, 0, namespace.dumpConfig, logErrors);\n    }\n\n    unsafeDumpJSObject(obj, variant, currentDepth, dumpConfig, logErrors) {\n        if (currentDepth >= dumpConfig.maxDepth) {\n            this.dumpMaxDepth(obj, variant, currentDepth, dumpConfig);\n            return;\n        }\n        this.dumpBaseObject(obj, variant, currentDepth, dumpConfig, logErrors);\n        if (undefined === obj) {\n            variant.setVariantType(variant_pb.Variant.Type.VARIANT_UNDEFINED);\n            return;\n        }\n\n        if (null === obj) {\n            variant.setVariantType(variant_pb.Variant.Type.VARIANT_NONE);\n            return;\n        }\n\n        if (obj === true || obj === false) {\n            variant.setVariantType(variant_pb.Variant.Type.VARIANT_INT);\n            variant.setIntValue(obj ? 1 : 0);\n            return;\n        }\n\n        // isFloat is not including int\n        if (isFloat(obj) || Number.isInteger(obj)) {\n            variant.setVariantType(variant_pb.Variant.Type.VARIANT_DOUBLE);\n            variant.setDoubleValue(obj);\n            return;\n        }\n\n        if (typeof obj === 'string' || obj instanceof String) {\n            variant.setVariantType(variant_pb.Variant.Type.VARIANT_STRING);\n\n            let string = new variant_pb.Variant.String();\n            string.setOriginalSize(obj.length);\n\n            if (obj.length > dumpConfig.maxString) {\n                string.setValue(obj.substring(0, dumpConfig.maxString));\n            } else {\n                string.setValue(obj);\n            }\n\n            variant.setStringValue(string);\n            return;\n        }\n\n        if (obj instanceof Date) {\n            variant.setVariantType(variant_pb.Variant.Type.VARIANT_TIME);\n\n            let date = new timestamp_pb.Timestamp();\n\n            if (isNaN(obj.getTime())) {\n                // date is not valid\n                obj = new Date(0);\n            }\n\n            date.fromDate(obj);\n\n            variant.setTimeValue(date);\n            return;\n        }\n\n        if (Array.isArray(obj)) {\n            this.dumpArray(obj, variant, currentDepth, dumpConfig, logErrors);\n            return;\n        }\n\n        if (obj instanceof Error) {\n            this.dumpException(obj, variant, currentDepth, dumpConfig, logErrors);\n            return;\n        }\n\n        if (typeof obj === 'function') {\n            variant.setVariantType(variant_pb.Variant.Type.VARIANT_CODE_OBJECT);\n\n            let codeValue = new variant_pb.Variant.CodeObject();\n            codeValue.setName(obj.name);\n\n            variant.setCodeValue(codeValue);\n            return;\n        }\n        this.dumpUserClass(obj, variant, currentDepth, dumpConfig, logErrors);\n    }\n\n    dumpJSObject(obj, variant, currentDepth, dumpConfig, logErrors) {\n        try {\n            this.unsafeDumpJSObject(obj, variant, currentDepth, dumpConfig, logErrors);\n        }\n        catch (e) {\n            const message = \"Failed to serialize object\";\n\n            this.clearVariant(variant);\n            variant.setVariantType(variant_pb.Variant.Type.VARIANT_ERROR);\n\n            if (logErrors) {\n                variant.setErrorValue(new RookError(e, message).dumps());\n                logger.exception(message, e);\n            }\n        }\n    }\n\n    dumpMaxDepth(variant) {\n        variant.setVariantType(variant_pb.Variant.Type.VARIANT_MAX_DEPTH);\n    }\n    setMaxDepthFlag(variant) {\n        variant.setMaxDepth(true);\n    }\n\n\n    dumpBaseObject(obj, variant, currentDepth, dumpConfig) {\n        // Try to get class name from prototype, if possible\n        try {\n            variant.setOriginalType(obj.__proto__.constructor.name)\n        } catch (e) {\n            variant.setOriginalType(typeof obj);\n        }\n\n        if (null === obj || undefined === obj) {\n            return;\n        }\n\n        // Don't dump values of strings or arrays as they cause issues\n        if (typeof obj === 'string' || obj instanceof String) {\n            return;\n        }\n\n        let symbols = Object.getOwnPropertySymbols(obj);\n        let objectKeys = Object.keys(obj);\n        let objectWidth = symbols.length + objectKeys.length;\n        let objectWeight = currentDepth + ((objectWidth >= dumpConfig.maxWidth) ? 2 : 1);\n        if ((objectWeight >= dumpConfig.maxDepth)) {\n            if (objectWidth){\n                this.setMaxDepthFlag(variant);\n            }\n            return;\n        }\n        for (let key of objectKeys) {\n\n            if (obj[key] === obj) {\n                continue;\n            }\n            // If it's an Array, ignore it's index attributes\n\n            if (Array.isArray(obj) && parseInt(key).toString() === key) {\n                continue;\n            }\n            let value = new variant_pb.Variant();\n\n            if ('get' in Object.getOwnPropertyDescriptor(obj, key)) {\n\n                value.setVariantType(variant_pb.Variant.Type.VARIANT_DYNAMIC);\n            } else {\n                this.dumpJSObject(obj[key], value, objectWeight, dumpConfig);\n            }\n            let attribute = new variant_pb.Variant.NamedValue();\n\n            attribute.setName(key);\n            attribute.setValue(value);\n            variant.addAttributes(attribute);\n\n        }\n        // Protect against primitives pointing to themselves\n        for (let index in symbols) {\n            let symbol = symbols[index];\n            let symbolName = symbol.toString();\n\n            let value = new variant_pb.Variant();\n            this.dumpJSObject(obj[symbol], value, objectWeight, dumpConfig);\n\n            let attribute = new variant_pb.Variant.NamedValue();\n            attribute.setName(symbolName);\n            attribute.setValue(value);\n\n            variant.addAttributes(attribute);\n        }\n\n\n    }\n\n    dumpArray(obj, variant, currentDepth, dumpConfig, logErrors) {\n        variant.setVariantType(variant_pb.Variant.Type.VARIANT_LIST);\n\n        let list = new variant_pb.Variant.List();\n        list.setType(ListNamespace.getCommonType(list));\n        list.setOriginalSize(obj.length);\n\n        if (currentDepth < dumpConfig.maxCollectionDepth) {\n\n            const maxItems = Math.min(obj.length, dumpConfig.maxWidth);\n            for (let i = 0; i < maxItems; ++i) {\n                let item = new variant_pb.Variant();\n                this.dumpJSObject(obj[i], item, currentDepth + 1, dumpConfig, logErrors);\n                list.addValues(item);\n            }\n        }\n\n        variant.setListValue(list);\n    }\n\n    dumpException(obj, variant, currentDepth, dumpConfig, logErrors) {\n        variant.setVariantType(variant_pb.Variant.Type.VARIANT_OBJECT);\n\n        let messageValue = new variant_pb.Variant();\n        this.dumpJSObject(obj.message, messageValue, currentDepth + 1, dumpConfig, logErrors);\n\n        let messagePair = new variant_pb.Variant.NamedValue();\n        messagePair.setName('message');\n        messagePair.setValue(messageValue);\n        variant.addAttributes(messagePair);\n\n        let stackValue = new variant_pb.Variant();\n        this.dumpJSObject(obj.stack, stackValue, currentDepth + 1, dumpConfig, logErrors);\n\n        let stackPair = new variant_pb.Variant.NamedValue();\n        stackPair.setName('stack');\n        stackPair.setValue(stackValue);\n        variant.addAttributes(stackPair);\n    }\n\n    dumpUserClass(obj, variant, currentDepth, dumpConfig) {\n        variant.setVariantType(variant_pb.Variant.Type.VARIANT_OBJECT);\n    }\n\n    dumpListNamespace(namespace, variant, logErrors) {\n        variant.setVariantType(variant_pb.Variant.Type.VARIANT_LIST);\n        variant.setOriginalType(namespace.originalType);\n\n        let listValue = new variant_pb.Variant.List();\n        listValue.setType(namespace.commonType);\n        listValue.setOriginalSize(namespace.originalSize);\n\n        for (let item of namespace.list) {\n            listValue.addValues(this.dumps(item, logErrors));\n        }\n\n        variant.setListValue(listValue);\n    }\n\n    dumpDictNamespace(namespace, variant, logErrors) {\n        variant.setVariantType(variant_pb.Variant.Type.VARIANT_MAP);\n        variant.setOriginalType(namespace.originalType);\n\n        let dictValue = new variant_pb.Variant.Map();\n        dictValue.setOriginalSize(namespace.originalSize);\n\n        for (let key of Object.keys(namespace.dict)) {\n            let pair = new variant_pb.Variant.Pair();\n\n            pair.setFirst(this.dumps(new JSObjectNamespace(key), logErrors));\n            pair.setSecond(this.dumps(new JSObjectNamespace(namespace.dict[key]), logErrors));\n\n            dictValue.addPairs(pair);\n        }\n\n        variant.setMapValue(dictValue);\n    }\n\n    unsafeDumpInspectorObjectNamespace(namespace, variant, currentDepth, dumpConfig, logErrors) {\n        if (currentDepth === dumpConfig.maxDepth) {\n            this.setMaxDepthFlag(variant);\n            return;\n        }\n\n        variant.setOriginalType(namespace.obj.className);\n\n        if (namespace.obj.type === 'function') {\n            variant.setVariantType(variant_pb.Variant.Type.VARIANT_CODE_OBJECT);\n\n            let functionName = '';\n            try {\n                functionName = namespace.readAttribute('name').obj;\n            } catch (e) { }\n\n            let codeValue = new variant_pb.Variant.CodeObject();\n            codeValue.setName(functionName);\n\n            variant.setCodeValue(codeValue);\n            return;\n        }\n\n        switch (namespace.obj.subtype) {\n            case 'array':\n                this.dumpInspectorArray(namespace, variant, currentDepth, dumpConfig);\n                break;\n\n            case 'date':\n                this.dumpInspectorDate(namespace, variant, currentDepth, dumpConfig);\n                break;\n\n            default:\n                variant.setVariantType(variant_pb.Variant.Type.VARIANT_OBJECT);\n        }\n\n        namespace.loadProperties();\n\n        if (currentDepth + 1 < dumpConfig.maxDepth) {\n            for (let property of namespace.properties) {\n                // If it's an Array, ignore it's index attributes and the length method\n                if (namespace.obj.subtype === 'array' &&\n                    (parseInt(property.name).toString() === property.name || property.name === 'length')) {\n                    continue;\n                }\n\n                // We don't dump proto automatically as it leads to very large dumps\n                if (property.name === '__proto__') {\n                    continue;\n                }\n\n                let item = new variant_pb.Variant();\n\n                if (property.value === null || property.value === undefined) {\n                    if ('get' in property) {\n                        this.dumpDynamicInspectorObjectNamespace(item);\n                    } else {\n                        throw new RookInspectorUnknownProperty(property);\n                    }\n                } else {\n                    let obj = InspectorObjectNamespace.getObjectInternal(namespace.inspector, property.value);\n\n                    if (obj instanceof InspectorObjectNamespace) {\n                        this.dumpInspectorObjectNamespace(obj, item, currentDepth + 1, dumpConfig, logErrors);\n                    } else {\n                        this.dumpJSObject(obj, item, currentDepth + 1, dumpConfig);\n                    }\n                }\n\n                let attribute = new variant_pb.Variant.NamedValue();\n                attribute.setName(property.name);\n                attribute.setValue(item);\n\n                variant.addAttributes(attribute);\n            }\n        } else if (namespace.properties && namespace.properties.length) {\n            variant.setMaxDepth(true);\n        }\n    }\n\n    dumpDynamicInspectorObjectNamespace(variant) {\n        variant.setVariantType(variant_pb.Variant.Type.VARIANT_DYNAMIC);\n    }\n\n    dumpInspectorObjectNamespace(namespace, variant, currentDepth, dumpConfig, logErrors) {\n        try {\n            this.unsafeDumpInspectorObjectNamespace(namespace, variant, currentDepth, dumpConfig, logErrors)\n        } catch (e) {\n            const message = \"Failed to serialize namespace\";\n\n            variant.setVariantType(variant_pb.Variant.Type.VARIANT_ERROR);\n\n            if (logErrors) {\n                variant.setErrorValue(new RookError(e, message).dumps());\n                logger.exception(message, e);\n            }\n        }\n    }\n\n    dumpInspectorArray(namespace, variant, currentDepth, dumpConfig, logErrors) {\n        variant.setVariantType(variant_pb.Variant.Type.VARIANT_LIST);\n\n        const lengthString = namespace.obj.description.match(/\\((\\d+)\\)/)[1];\n        const length = parseInt(lengthString);\n\n        let list = new variant_pb.Variant.List();\n        list.setType(ListNamespace.getCommonType(list));\n        list.setOriginalSize(length);\n\n        const maxItems = Math.min(length, dumpConfig.maxWidth);\n\n        if (currentDepth < dumpConfig.maxCollectionDepth) {\n\n            for (let i = 0; i < maxItems; ++i) {\n                let obj = null;\n\n                // Sparse arrays have missing objects as undefined\n                try {\n                    obj = namespace.readAttribute(i.toString());\n                } catch (e) {\n                    obj = new JSObjectNamespace(undefined);\n                }\n\n                let item = new variant_pb.Variant();\n\n                if (obj instanceof InspectorObjectNamespace) {\n                    this.dumpInspectorObjectNamespace(obj, item, currentDepth + 1, dumpConfig, logErrors);\n                } else {\n                    this.dumpJSObject(obj.obj, item, currentDepth + 1, dumpConfig, logErrors);\n                }\n\n                list.addValues(item);\n            }\n        }\n\n        variant.setListValue(list);\n    }\n\n    dumpInspectorDate(namespace, variant, currentDepth, dumpConfig) {\n        variant.setVariantType(variant_pb.Variant.Type.VARIANT_TIME);\n\n        let date = new timestamp_pb.Timestamp();\n\n        let timeValue = namespace.obj.description;\n        if (isNaN(timeValue.getTime())) {\n            // date is not valid\n            timeValue = new Date(0);\n        }\n\n        date.fromDate(new Date(timeValue));\n\n        variant.setTimeValue(date);\n    }\n\n    clearVariant(variant) {\n        variant.setVariantType(undefined);\n        variant.setOriginalType(undefined);\n        variant.clearAttributesList();\n\n        variant.clearIntValue();\n        variant.clearLongValue();\n        variant.clearDoubleValue();\n        variant.clearStringValue();\n        variant.clearListValue();\n        variant.clearMapValue();\n        variant.clearNamespaceValue();\n        variant.clearErrorValue();\n        variant.clearMessageValue();\n        variant.clearTimeValue();\n        variant.clearCodeValue();\n        variant.clearLargeIntValue();\n        variant.clearComplexValue();\n    }\n}\n"],"file":"NamespaceSerializer.js"}